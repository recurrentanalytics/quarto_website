{
  "hash": "5ffaf6c02ae258b82b8668e990ae0707",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Identify Extreme Events\npage-layout: article\n---\n\n\n\n# Projects\n\nPackaged work, demos, models, and interactive tools from the lab.\n\n::: {.project-filters}\n**Filter:** \n<button class=\"filter-btn active\" data-filter=\"all\">All</button>\n<button class=\"filter-btn\" data-filter=\"project\">Projects</button>\n<button class=\"filter-btn\" data-filter=\"tool\">Tools</button>\n<button class=\"filter-btn\" data-filter=\"model\">Models</button>\n<button class=\"filter-btn\" data-filter=\"demo\">Demos</button>\n:::\n\n::: {.projects-grid}\n::: {.project-card data-category=\"model\"}\n## Heatwaves and Day-Ahead Prices\n\n**Status:** Active  \n**Category:** Model / Analysis\n\nAnalysis of electricity day-ahead prices in Germany-Luxembourg during heatwave events. Explores the relationship between extreme temperatures and energy market dynamics.\n\n**Links:**\n- [View Analysis ‚Üí](../models/heatwave-prices-de-lu.qmd)\n\n**Technologies:** Python, Pandas, OPSD Data\n:::\n\n::: {.project-card data-category=\"demo\"}\n## ERA5 Rainfall Demo\n\n**Status:** Active  \n**Category:** Demo / Tool\n\nInteractive demonstration of ERA5 reanalysis data for rainfall analysis. Shows data loading, processing, and visualization workflows.\n\n**Links:**\n- [View Demo ‚Üí](../models/era5-demo.qmd)\n\n**Technologies:** Python, ERA5 Data, Climate Analysis\n:::\n\n::: {.project-card data-category=\"project\"}\n## Project Template\n\n**Status:** Coming soon  \n**Category:** Project\n\nBrief description of the project, its goals, and key features.\n\n**Links:**\n- [Demo](link-to-demo) (if available)\n- [Code](link-to-repo) (if available)\n- [Documentation](link-to-docs) (if available)\n\n**Technologies:** Python, R, JavaScript, etc.\n:::\n:::\n\n<style>\n.project-filters {\n  margin: 2rem 0 1.5rem;\n  padding: 1rem;\n  background: var(--bs-tertiary-bg);\n  border-radius: 0.5rem;\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  flex-wrap: wrap;\n}\n\n.filter-btn {\n  padding: 0.4rem 0.75rem;\n  border: 1px solid var(--bs-border-color);\n  background: var(--bs-body-bg);\n  color: var(--bs-body-color);\n  border-radius: 0.25rem;\n  font-size: 0.9rem;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.filter-btn:hover {\n  border-color: var(--bs-primary);\n  background: var(--bs-tertiary-bg);\n}\n\n.filter-btn.active {\n  background: var(--bs-primary);\n  color: var(--bs-body-bg);\n  border-color: var(--bs-primary);\n}\n\n.projects-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n  gap: 1.5rem;\n  margin: 2rem 0;\n}\n\n.project-card {\n  padding: 1.5rem;\n  border: 1px solid var(--bs-border-color);\n  border-radius: 0.5rem;\n  background: var(--bs-body-bg);\n  transition: all 0.2s ease;\n  position: relative;\n}\n\n.project-card:hover {\n  border-color: var(--bs-secondary);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  transform: translateY(-2px);\n}\n\n.project-card h3 {\n  margin-top: 0;\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin-bottom: 0.75rem;\n}\n\n.project-card p {\n  margin-bottom: 1rem;\n  color: var(--bs-body-color);\n  line-height: 1.6;\n}\n\n.project-card[data-category]::before {\n  content: attr(data-category);\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  padding: 0.25rem 0.5rem;\n  background: var(--bs-tertiary-bg);\n  border: 1px solid var(--bs-border-color);\n  border-radius: 0.25rem;\n  font-size: 0.75rem;\n  text-transform: uppercase;\n  font-weight: 600;\n  color: var(--bs-secondary);\n}\n\n.project-card[data-category=\"model\"]::before {\n  background: rgba(var(--bs-success-rgb), 0.1);\n  border-color: var(--bs-success);\n  color: var(--bs-success);\n}\n\n.project-card[data-category=\"demo\"]::before {\n  background: rgba(var(--bs-info-rgb), 0.1);\n  border-color: var(--bs-info);\n  color: var(--bs-info);\n}\n\n.project-card[data-category=\"tool\"]::before {\n  background: rgba(var(--bs-warning-rgb), 0.1);\n  border-color: var(--bs-warning);\n  color: var(--bs-warning);\n}\n\n.project-card[data-category=\"project\"]::before {\n  background: rgba(var(--bs-primary-rgb), 0.1);\n  border-color: var(--bs-primary);\n  color: var(--bs-primary);\n}\n\n@media (max-width: 768px) {\n  .projects-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .project-filters {\n    font-size: 0.9rem;\n  }\n  \n  .filter-btn {\n    padding: 0.35rem 0.6rem;\n    font-size: 0.85rem;\n  }\n}\n</style>\n\n<script>\ndocument.addEventListener('DOMContentLoaded', function() {\n  const filterBtns = document.querySelectorAll('.filter-btn');\n  const projectCards = document.querySelectorAll('.project-card');\n  \n  filterBtns.forEach(btn => {\n    btn.addEventListener('click', function() {\n      // Update active state\n      filterBtns.forEach(b => b.classList.remove('active'));\n      this.classList.add('active');\n      \n      const filter = this.dataset.filter;\n      \n      // Filter cards\n      projectCards.forEach(card => {\n        if (filter === 'all' || card.dataset.category === filter) {\n          card.style.display = '';\n        } else {\n          card.style.display = 'none';\n        }\n      });\n    });\n  });\n});\n</script>\n\n---\n\n## Climate Extremes Explorer\n\nInteractive analysis of climate extremes using synthetic climate data. This demonstration showcases methods for identifying, analyzing, and visualizing extreme climate events including heatwaves, cold snaps, and extreme precipitation.\n\n### Generate and Load Climate Data\n\n::: {#02061670 .cell execution_count=1}\n``` {.python .cell-code}\nimport sys\nimport os\nsys.path.insert(0, os.path.abspath('.'))\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\ntry:\n    import seaborn as sns\n    HAS_SEABORN = True\nexcept ImportError:\n    HAS_SEABORN = False\n    print(\"Note: seaborn not available, using matplotlib for heatmap\")\nfrom scipy import stats\n\nfrom src.climate_extremes import (\n    generate_synthetic_climate_data,\n    identify_extremes,\n    compute_return_periods,\n    analyze_correlations,\n    cluster_extreme_events,\n    compute_extreme_statistics,\n)\n\n# Generate synthetic climate data (2000-2023, daily)\nprint(\"Generating synthetic climate data...\")\nclimate_data = generate_synthetic_climate_data(\n    start_date=\"2000-01-01\",\n    end_date=\"2023-12-31\",\n    freq=\"D\",\n    seed=42\n)\n\nprint(f\"\\nData shape: {climate_data.shape}\")\nprint(f\"Date range: {climate_data['datetime_utc'].min()} to {climate_data['datetime_utc'].max()}\")\nprint(\"\\nFirst few rows:\")\nprint(climate_data.head())\nprint(\"\\nSummary statistics:\")\nprint(climate_data[['temperature_c', 'precipitation_mm', 'pressure_hpa']].describe())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGenerating synthetic climate data...\n\nData shape: (8766, 4)\nDate range: 2000-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00\n\nFirst few rows:\n               datetime_utc  temperature_c  precipitation_mm  pressure_hpa\n0 2000-01-01 00:00:00+00:00      16.490142          1.987423   1016.294377\n1 2000-01-02 00:00:00+00:00      14.757278          3.775058   1017.524657\n2 2000-01-03 00:00:00+00:00      17.287156          3.904062   1009.176811\n3 2000-01-04 00:00:00+00:00      20.085098          6.355532    999.046500\n4 2000-01-05 00:00:00+00:00      14.985313          0.236418   1014.740259\n\nSummary statistics:\n       temperature_c  precipitation_mm  pressure_hpa\ncount    8766.000000       8766.000000   8766.000000\nmean       15.773961          4.322842   1013.243240\nstd         8.838041          6.592951      6.677491\nmin       -19.483457          0.026432    985.935802\n25%         8.700376          1.648959   1008.784265\n50%        15.748301          3.060113   1013.282316\n75%        22.461284          5.356232   1017.790731\nmax        56.866253        316.088010   1039.191900\n```\n:::\n:::\n\n\n\n\n::: {#3505b81f .cell execution_count=2}\n``` {.python .cell-code}\n# Identify extreme temperature events (95th percentile, minimum 3 consecutive days)\nclimate_data = identify_extremes(\n    climate_data,\n    variable='temperature_c',\n    method='percentile',\n    threshold=95.0,\n    min_duration=3\n)\n\n# Also identify extreme precipitation events\nclimate_data = identify_extremes(\n    climate_data,\n    variable='precipitation_mm',\n    method='percentile',\n    threshold=95.0,\n    min_duration=1\n)\n\n# Compute statistics\ntemp_stats = compute_extreme_statistics(climate_data, 'temperature_c')\nprecip_stats = compute_extreme_statistics(climate_data, 'precipitation_mm')\n\nprint(\"Temperature Extreme Events:\")\nprint(f\"  Number of events: {temp_stats['n_events']}\")\nprint(f\"  Total extreme days: {temp_stats['total_days']}\")\nprint(f\"  Mean intensity: {temp_stats['mean_intensity']:.2f}¬∞C above threshold\")\nprint(f\"  Maximum intensity: {temp_stats['max_intensity']:.2f}¬∞C above threshold\")\nprint(f\"  Mean duration: {temp_stats['mean_duration']:.1f} days\")\n\nprint(\"\\nPrecipitation Extreme Events:\")\nprint(f\"  Number of events: {precip_stats['n_events']}\")\nprint(f\"  Total extreme days: {precip_stats['total_days']}\")\nprint(f\"  Mean intensity: {precip_stats['mean_intensity']:.2f} mm above threshold\")\nprint(f\"  Maximum intensity: {precip_stats['max_intensity']:.2f} mm above threshold\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTemperature Extreme Events:\n  Number of events: 399\n  Total extreme days: 439\n  Mean intensity: 8.34¬∞C above threshold\n  Maximum intensity: 304.83¬∞C above threshold\n  Mean duration: 1.1 days\n\nPrecipitation Extreme Events:\n  Number of events: 399\n  Total extreme days: 439\n  Mean intensity: 8.34 mm above threshold\n  Maximum intensity: 304.83 mm above threshold\n```\n:::\n:::\n\n\n### Extreme Event Timeline\n\n::: {#860cab71 .cell execution_count=3}\n``` {.python .cell-code}\n# Create timeline visualization with extreme events highlighted\nfig, axes = plt.subplots(3, 1, figsize=(14, 10), sharex=True)\n\n# Temperature with extreme events\nax1 = axes[0]\nax1.plot(climate_data['datetime_utc'], climate_data['temperature_c'], \n         color='#2c3e50', alpha=0.6, linewidth=0.8, label='Temperature')\nax1.scatter(climate_data[climate_data['is_extreme']]['datetime_utc'],\n           climate_data[climate_data['is_extreme']]['temperature_c'],\n           c='#e74c3c', s=30, alpha=0.7, label='Extreme Events', zorder=5)\nax1.axhline(y=np.percentile(climate_data['temperature_c'], 95), \n           color='#c0392b', linestyle='--', alpha=0.7, label='95th Percentile')\nax1.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature Time Series with Extreme Events Highlighted', \n              fontsize=13, fontweight='bold', pad=10)\nax1.legend(loc='upper left', fontsize=9)\nax1.grid(True, alpha=0.3)\n\n# Precipitation with extreme events\nax2 = axes[1]\nax2.plot(climate_data['datetime_utc'], climate_data['precipitation_mm'], \n         color='#3498db', alpha=0.6, linewidth=0.8, label='Precipitation')\nprecip_extremes = climate_data[climate_data['precipitation_mm'] >= \n                               np.percentile(climate_data['precipitation_mm'], 95)]\nax2.scatter(precip_extremes['datetime_utc'], precip_extremes['precipitation_mm'],\n           c='#2980b9', s=30, alpha=0.7, label='Extreme Events', zorder=5)\nax2.axhline(y=np.percentile(climate_data['precipitation_mm'], 95), \n           color='#21618c', linestyle='--', alpha=0.7, label='95th Percentile')\nax2.set_ylabel('Precipitation (mm)', fontsize=11, fontweight='bold')\nax2.set_title('Precipitation Time Series with Extreme Events Highlighted', \n              fontsize=13, fontweight='bold', pad=10)\nax2.legend(loc='upper left', fontsize=9)\nax2.grid(True, alpha=0.3)\n\n# Pressure\nax3 = axes[2]\nax3.plot(climate_data['datetime_utc'], climate_data['pressure_hpa'], \n         color='#7f8c8d', alpha=0.6, linewidth=0.8)\nax3.set_ylabel('Pressure (hPa)', fontsize=11, fontweight='bold')\nax3.set_xlabel('Date', fontsize=11, fontweight='bold')\nax3.set_title('Atmospheric Pressure Time Series', \n              fontsize=13, fontweight='bold', pad=10)\nax3.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-4-output-1.png){width=1335 height=949}\n:::\n:::\n\n\n### Return Period Analysis\n\n::: {#565ebe12 .cell execution_count=4}\n``` {.python .cell-code}\n# Compute return periods for temperature extremes\nreturn_periods_temp = compute_return_periods(\n    climate_data,\n    variable='temperature_c',\n    method='block_maxima',\n    block_size='1Y'\n)\n\nreturn_periods_precip = compute_return_periods(\n    climate_data,\n    variable='precipitation_mm',\n    method='peaks_over_threshold',\n)\n\nfig, axes = plt.subplots(1, 2, figsize=(14, 5))\n\n# Temperature return periods\nax1 = axes[0]\nax1.plot(return_periods_temp['return_period_years'], \n        return_periods_temp['return_value'], \n        marker='o', linewidth=2, markersize=8, color='#e74c3c')\nax1.set_xlabel('Return Period (years)', fontsize=11, fontweight='bold')\nax1.set_ylabel('Return Value (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature: Return Period Analysis\\n(Annual Maxima Method)', \n              fontsize=12, fontweight='bold')\nax1.grid(True, alpha=0.3)\nax1.set_xscale('log')\n\n# Precipitation return periods\nax2 = axes[1]\nax2.plot(return_periods_precip['return_period_years'], \n        return_periods_precip['return_value'], \n        marker='o', linewidth=2, markersize=8, color='#3498db')\nax2.set_xlabel('Return Period (years)', fontsize=11, fontweight='bold')\nax2.set_ylabel('Return Value (mm)', fontsize=11, fontweight='bold')\nax2.set_title('Precipitation: Return Period Analysis\\n(Peaks Over Threshold Method)', \n              fontsize=12, fontweight='bold')\nax2.grid(True, alpha=0.3)\nax2.set_xscale('log')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"Return Period Analysis Results:\")\nprint(\"\\nTemperature (Annual Maxima):\")\nprint(return_periods_temp.to_string(index=False))\nprint(\"\\nPrecipitation (Peaks Over Threshold):\")\nprint(return_periods_precip.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-5-output-1.png){width=1335 height=469}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nReturn Period Analysis Results:\n\nTemperature (Annual Maxima):\n return_period_years  return_value      variable\n                   2     42.794460 temperature_c\n                   5     47.875623 temperature_c\n                  10     50.035892 temperature_c\n                  20     51.623194 temperature_c\n                  50     53.232872 temperature_c\n                 100     54.216806 temperature_c\n                 200     55.062521 temperature_c\n                 500     56.024671 temperature_c\n\nPrecipitation (Peaks Over Threshold):\n return_period_years  return_value         variable\n                   2           NaN precipitation_mm\n                   5           NaN precipitation_mm\n                  10           NaN precipitation_mm\n                  20     11.267369 precipitation_mm\n                  50     15.124830 precipitation_mm\n                 100     20.049680 precipitation_mm\n                 200     27.822761 precipitation_mm\n                 500     45.390184 precipitation_mm\n```\n:::\n:::\n\n\n### Multi-Variable Correlation Analysis\n\n::: {#cb520d26 .cell execution_count=5}\n``` {.python .cell-code}\n# Compute correlation matrix\ncorr_matrix = analyze_correlations(\n    climate_data,\n    variables=['temperature_c', 'precipitation_mm', 'pressure_hpa']\n)\n\n# Create heatmap\nfig, ax = plt.subplots(figsize=(8, 6))\nif HAS_SEABORN:\n    sns.heatmap(corr_matrix, annot=True, fmt='.3f', cmap='RdBu_r', center=0,\n               square=True, linewidths=1, cbar_kws={\"shrink\": 0.8},\n               vmin=-1, vmax=1, ax=ax)\nelse:\n    im = ax.imshow(corr_matrix.values, cmap='RdBu_r', vmin=-1, vmax=1, aspect='auto')\n    ax.set_xticks(range(len(corr_matrix.columns)))\n    ax.set_yticks(range(len(corr_matrix.index)))\n    ax.set_xticklabels(corr_matrix.columns)\n    ax.set_yticklabels(corr_matrix.index)\n    for i in range(len(corr_matrix.index)):\n        for j in range(len(corr_matrix.columns)):\n            ax.text(j, i, f'{corr_matrix.iloc[i, j]:.3f}', \n                   ha='center', va='center', color='black' if abs(corr_matrix.iloc[i, j]) < 0.5 else 'white')\n    plt.colorbar(im, ax=ax, shrink=0.8)\nax.set_title('Climate Variables Correlation Matrix', \n             fontsize=13, fontweight='bold', pad=15)\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nCorrelation Matrix:\")\nprint(corr_matrix)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-6-output-1.png){width=638 height=565}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCorrelation Matrix:\n                  temperature_c  precipitation_mm  pressure_hpa\ntemperature_c          1.000000         -0.196128     -0.661777\nprecipitation_mm      -0.196128          1.000000      0.139706\npressure_hpa          -0.661777          0.139706      1.000000\n```\n:::\n:::\n\n\n### Extreme Event Clustering\n\n::: {#918d9e9e .cell execution_count=6}\n``` {.python .cell-code}\n# Cluster extreme temperature events\nclimate_data = cluster_extreme_events(\n    climate_data,\n    n_clusters=5,\n    variables=['temperature_c', 'precipitation_mm', 'pressure_hpa']\n)\n\n# Visualize clustered extreme events\nfig, axes = plt.subplots(2, 1, figsize=(14, 10), sharex=True)\n\n# Temperature with cluster colors\nax1 = axes[0]\nscatter = ax1.scatter(climate_data['datetime_utc'], climate_data['temperature_c'],\n                     c=climate_data['extreme_cluster'], cmap='Set1', \n                     s=20, alpha=0.6, edgecolors='black', linewidth=0.5)\nextreme_mask = climate_data['is_extreme']\nax1.scatter(climate_data[extreme_mask]['datetime_utc'],\n           climate_data[extreme_mask]['temperature_c'],\n           c=climate_data[extreme_mask]['extreme_cluster'], cmap='Set1',\n           s=100, alpha=0.9, edgecolors='black', linewidth=1.5, \n           marker='*', zorder=5, label='Extreme Events')\nax1.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature Time Series with Clustered Extreme Events', \n              fontsize=13, fontweight='bold', pad=10)\ncbar = plt.colorbar(scatter, ax=ax1)\ncbar.set_label('Cluster ID', fontsize=10)\nax1.legend(loc='upper left', fontsize=9)\nax1.grid(True, alpha=0.3)\n\n# Cluster characteristics\nax2 = axes[1]\ncluster_stats = climate_data[climate_data['extreme_cluster'] > 0].groupby('extreme_cluster').agg({\n    'temperature_c': 'mean',\n    'precipitation_mm': 'mean',\n    'pressure_hpa': 'mean',\n    'extreme_intensity': 'mean',\n}).reset_index()\n\nx_pos = np.arange(len(cluster_stats))\nwidth = 0.35\nax2.bar(x_pos - width/2, cluster_stats['temperature_c'], width, \n       label='Temperature', color='#e74c3c', alpha=0.7)\nax2_twin = ax2.twinx()\nax2_twin.bar(x_pos + width/2, cluster_stats['precipitation_mm'], width,\n            label='Precipitation', color='#3498db', alpha=0.7)\nax2.set_xlabel('Cluster ID', fontsize=11, fontweight='bold')\nax2.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold', color='#e74c3c')\nax2_twin.set_ylabel('Precipitation (mm)', fontsize=11, fontweight='bold', color='#3498db')\nax2.set_title('Cluster Characteristics: Mean Values by Cluster', \n              fontsize=13, fontweight='bold', pad=10)\nax2.set_xticks(x_pos)\nax2.set_xticklabels(cluster_stats['extreme_cluster'])\nax2.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nCluster Statistics:\")\nprint(cluster_stats.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-7-output-1.png){width=1335 height=949}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCluster Statistics:\n extreme_cluster  temperature_c  precipitation_mm  pressure_hpa  extreme_intensity\n               1       5.499854         14.701148   1020.549791           3.438765\n               2       5.956776        200.997156   1021.397432         189.734773\n               3      26.091330         16.614513   1006.965570           5.352129\n               4      12.662559         63.720836   1017.063492          52.458453\n               5      12.641321         16.681648   1011.837337           5.419265\n```\n:::\n:::\n\n\n### Extreme Event Intensity Distribution\n\n::: {#81ec261f .cell execution_count=7}\n``` {.python .cell-code}\n# Analyze distribution of extreme event intensities\nextreme_events = climate_data[climate_data['is_extreme']].copy()\n\nfig, axes = plt.subplots(1, 2, figsize=(14, 5))\n\n# Histogram of extreme intensities\nax1 = axes[0]\nax1.hist(extreme_events['extreme_intensity'], bins=30, color='#e74c3c', \n        alpha=0.7, edgecolor='black', linewidth=1.2)\nax1.axvline(extreme_events['extreme_intensity'].mean(), \n           color='#c0392b', linestyle='--', linewidth=2, \n           label=f\"Mean: {extreme_events['extreme_intensity'].mean():.2f}¬∞C\")\nax1.axvline(extreme_events['extreme_intensity'].median(), \n           color='#8e44ad', linestyle='--', linewidth=2,\n           label=f\"Median: {extreme_events['extreme_intensity'].median():.2f}¬∞C\")\nax1.set_xlabel('Extreme Intensity (¬∞C above threshold)', fontsize=11, fontweight='bold')\nax1.set_ylabel('Frequency', fontsize=11, fontweight='bold')\nax1.set_title('Distribution of Extreme Event Intensities', \n              fontsize=12, fontweight='bold')\nax1.legend(fontsize=9)\nax1.grid(True, alpha=0.3, axis='y')\n\n# Box plot by cluster\nax2 = axes[1]\ncluster_data = [extreme_events[extreme_events['extreme_cluster'] == i]['extreme_intensity'].values\n                for i in sorted(extreme_events['extreme_cluster'].unique()) if i > 0]\nbp = ax2.boxplot(cluster_data, labels=sorted(extreme_events['extreme_cluster'].unique())[1:],\n                patch_artist=True, showmeans=True)\nfor patch in bp['boxes']:\n    patch.set_facecolor('#e74c3c')\n    patch.set_alpha(0.7)\nax2.set_xlabel('Cluster ID', fontsize=11, fontweight='bold')\nax2.set_ylabel('Extreme Intensity (¬∞C above threshold)', fontsize=11, fontweight='bold')\nax2.set_title('Extreme Intensity Distribution by Cluster', \n              fontsize=12, fontweight='bold')\nax2.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nExtreme Event Intensity Statistics:\")\nprint(extreme_events['extreme_intensity'].describe())\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">ValueError</span>                                Traceback (most recent call last)\n<span class=\"ansi-cyan-fg\">Cell</span><span class=\"ansi-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[7]</span><span class=\"ansi-green-fg\">, line 27</span>\n<span class=\"ansi-green-fg\">     24</span> ax2 = axes[<span class=\"ansi-green-fg\">1</span>]\n<span class=\"ansi-green-fg\">     25</span> cluster_data = [extreme_events[extreme_events[<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">extreme_cluster</span><span class=\"ansi-yellow-fg\">'</span>] == i][<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">extreme_intensity</span><span class=\"ansi-yellow-fg\">'</span>].values\n<span class=\"ansi-green-fg\">     26</span>                 <span style=\"font-weight:bold;color:rgb(0,135,0)\">for</span> i <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> <span style=\"color:rgb(0,135,0)\">sorted</span>(extreme_events[<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">extreme_cluster</span><span class=\"ansi-yellow-fg\">'</span>].unique()) <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> i &gt; <span class=\"ansi-green-fg\">0</span>]\n<span class=\"ansi-green-fg\">---&gt; </span><span class=\"ansi-green-fg\">27</span> bp = <span class=\"ansi-yellow-bg\">ax2</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">boxplot</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">cluster_data</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">labels</span><span class=\"ansi-yellow-bg\">=</span><span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">sorted</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">extreme_events</span><span class=\"ansi-yellow-bg\">[</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">extreme_cluster</span><span class=\"ansi-yellow-fg ansi-yellow-bg\">'</span><span class=\"ansi-yellow-bg\">]</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">unique</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">)</span><span class=\"ansi-yellow-bg\">)</span><span class=\"ansi-yellow-bg\">[</span><span class=\"ansi-green-fg ansi-yellow-bg\">1</span><span class=\"ansi-yellow-bg\">:</span><span class=\"ansi-yellow-bg\">]</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg\">     28</span> <span class=\"ansi-yellow-bg\">                </span><span class=\"ansi-yellow-bg\">patch_artist</span><span class=\"ansi-yellow-bg\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">True</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">showmeans</span><span class=\"ansi-yellow-bg\">=</span><span style=\"font-weight:bold;color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">True</span><span class=\"ansi-yellow-bg\">)</span>\n<span class=\"ansi-green-fg\">     29</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">for</span> patch <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> bp[<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">boxes</span><span class=\"ansi-yellow-fg\">'</span>]:\n<span class=\"ansi-green-fg\">     30</span>     patch.set_facecolor(<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">#e74c3c</span><span class=\"ansi-yellow-fg\">'</span>)\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">~/miniforge3/envs/climada/lib/python3.11/site-packages/matplotlib/_api/deprecation.py:453</span>, in <span class=\"ansi-cyan-fg\">make_keyword_only.&lt;locals&gt;.wrapper</span><span class=\"ansi-blue-fg\">(*args, **kwargs)</span>\n<span class=\"ansi-green-fg\">    447</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> <span style=\"color:rgb(0,135,0)\">len</span>(args) &gt; name_idx:\n<span class=\"ansi-green-fg\">    448</span>     warn_deprecated(\n<span class=\"ansi-green-fg\">    449</span>         since, message=<span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">Passing the </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">%(name)s</span><span class=\"ansi-yellow-fg\"> </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">%(obj_type)s</span><span class=\"ansi-yellow-fg\"> </span><span class=\"ansi-yellow-fg\">\"</span>\n<span class=\"ansi-green-fg\">    450</span>         <span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">positionally is deprecated since Matplotlib </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">%(since)s</span><span class=\"ansi-yellow-fg\">; the </span><span class=\"ansi-yellow-fg\">\"</span>\n<span class=\"ansi-green-fg\">    451</span>         <span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">parameter will become keyword-only in </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">%(removal)s</span><span class=\"ansi-yellow-fg\">.</span><span class=\"ansi-yellow-fg\">\"</span>,\n<span class=\"ansi-green-fg\">    452</span>         name=name, obj_type=<span class=\"ansi-yellow-fg\">f</span><span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">parameter of </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">{</span>func.<span class=\"ansi-blue-fg\">__name__</span><span style=\"font-weight:bold;color:rgb(175,95,135)\">}</span><span class=\"ansi-yellow-fg\">()</span><span class=\"ansi-yellow-fg\">\"</span>)\n<span class=\"ansi-green-fg\">--&gt; </span><span class=\"ansi-green-fg\">453</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span class=\"ansi-yellow-bg\">func</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">args</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">kwargs</span><span class=\"ansi-yellow-bg\">)</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">~/miniforge3/envs/climada/lib/python3.11/site-packages/matplotlib/__init__.py:1524</span>, in <span class=\"ansi-cyan-fg\">_preprocess_data.&lt;locals&gt;.inner</span><span class=\"ansi-blue-fg\">(ax, data, *args, **kwargs)</span>\n<span class=\"ansi-green-fg\">   1521</span> <span style=\"color:rgb(175,0,255)\">@functools</span>.wraps(func)\n<span class=\"ansi-green-fg\">   1522</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">def</span><span style=\"color:rgb(188,188,188)\"> </span><span class=\"ansi-blue-fg\">inner</span>(ax, *args, data=<span style=\"font-weight:bold;color:rgb(0,135,0)\">None</span>, **kwargs):\n<span class=\"ansi-green-fg\">   1523</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> data <span style=\"font-weight:bold;color:rgb(175,0,255)\">is</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">None</span>:\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">1524</span>         <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span class=\"ansi-yellow-bg\">func</span><span class=\"ansi-yellow-bg\">(</span>\n<span class=\"ansi-green-fg\">   1525</span> <span class=\"ansi-yellow-bg\">            </span><span class=\"ansi-yellow-bg\">ax</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg\">   1526</span> <span class=\"ansi-yellow-bg\">            </span><span class=\"ansi-yellow-bg\">*</span><span style=\"color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">map</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">cbook</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">sanitize_sequence</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">args</span><span class=\"ansi-yellow-bg\">)</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg\">   1527</span> <span class=\"ansi-yellow-bg\">            </span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">{</span><span class=\"ansi-yellow-bg\">k</span><span class=\"ansi-yellow-bg\">:</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">cbook</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">sanitize_sequence</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">v</span><span class=\"ansi-yellow-bg\">)</span><span class=\"ansi-yellow-bg\"> </span><span style=\"font-weight:bold;color:rgb(0,135,0)\" class=\"ansi-yellow-bg\">for</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">k</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">v</span><span class=\"ansi-yellow-bg\"> </span><span style=\"font-weight:bold;color:rgb(175,0,255)\" class=\"ansi-yellow-bg\">in</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">kwargs</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">items</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">)</span><span class=\"ansi-yellow-bg\">}</span><span class=\"ansi-yellow-bg\">)</span>\n<span class=\"ansi-green-fg\">   1529</span>     bound = new_sig.bind(ax, *args, **kwargs)\n<span class=\"ansi-green-fg\">   1530</span>     auto_label = (bound.arguments.get(label_namer)\n<span class=\"ansi-green-fg\">   1531</span>                   <span style=\"font-weight:bold;color:rgb(175,0,255)\">or</span> bound.kwargs.get(label_namer))\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">~/miniforge3/envs/climada/lib/python3.11/site-packages/matplotlib/_api/deprecation.py:295</span>, in <span class=\"ansi-cyan-fg\">rename_parameter.&lt;locals&gt;.wrapper</span><span class=\"ansi-blue-fg\">(*args, **kwargs)</span>\n<span class=\"ansi-green-fg\">    290</span>     warn_deprecated(\n<span class=\"ansi-green-fg\">    291</span>         since, message=<span class=\"ansi-yellow-fg\">f</span><span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">The </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">{</span>old<span style=\"font-weight:bold;color:rgb(175,95,135)\">!r}</span><span class=\"ansi-yellow-fg\"> parameter of </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">{</span>func.<span class=\"ansi-blue-fg\">__name__</span><span style=\"font-weight:bold;color:rgb(175,95,135)\">}</span><span class=\"ansi-yellow-fg\">() </span><span class=\"ansi-yellow-fg\">\"</span>\n<span class=\"ansi-green-fg\">    292</span>         <span class=\"ansi-yellow-fg\">f</span><span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">has been renamed </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">{</span>new<span style=\"font-weight:bold;color:rgb(175,95,135)\">!r}</span><span class=\"ansi-yellow-fg\"> since Matplotlib </span><span style=\"font-weight:bold;color:rgb(175,95,135)\">{</span>since<span style=\"font-weight:bold;color:rgb(175,95,135)\">}</span><span class=\"ansi-yellow-fg\">; support </span><span class=\"ansi-yellow-fg\">\"</span>\n<span class=\"ansi-green-fg\">    293</span>         <span class=\"ansi-yellow-fg\">f</span><span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">for the old name will be dropped in %(removal)s.</span><span class=\"ansi-yellow-fg\">\"</span>)\n<span class=\"ansi-green-fg\">    294</span>     kwargs[new] = kwargs.pop(old)\n<span class=\"ansi-green-fg\">--&gt; </span><span class=\"ansi-green-fg\">295</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">return</span> <span class=\"ansi-yellow-bg\">func</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">args</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">*</span><span class=\"ansi-yellow-bg\">kwargs</span><span class=\"ansi-yellow-bg\">)</span>\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">~/miniforge3/envs/climada/lib/python3.11/site-packages/matplotlib/axes/_axes.py:4138</span>, in <span class=\"ansi-cyan-fg\">Axes.boxplot</span><span class=\"ansi-blue-fg\">(self, x, notch, sym, vert, orientation, whis, positions, widths, patch_artist, bootstrap, usermedians, conf_intervals, meanline, showmeans, showcaps, showbox, showfliers, boxprops, tick_labels, flierprops, medianprops, meanprops, capprops, whiskerprops, manage_ticks, autorange, zorder, capwidths, label)</span>\n<span class=\"ansi-green-fg\">   4135</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> bootstrap <span style=\"font-weight:bold;color:rgb(175,0,255)\">is</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">None</span>:\n<span class=\"ansi-green-fg\">   4136</span>     bootstrap = mpl.rcParams[<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">boxplot.bootstrap</span><span class=\"ansi-yellow-fg\">'</span>]\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">4138</span> bxpstats = <span class=\"ansi-yellow-bg\">cbook</span><span class=\"ansi-yellow-bg\">.</span><span class=\"ansi-yellow-bg\">boxplot_stats</span><span class=\"ansi-yellow-bg\">(</span><span class=\"ansi-yellow-bg\">x</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">whis</span><span class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">whis</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">bootstrap</span><span class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">bootstrap</span><span class=\"ansi-yellow-bg\">,</span>\n<span class=\"ansi-green-fg\">   4139</span> <span class=\"ansi-yellow-bg\">                               </span><span class=\"ansi-yellow-bg\">labels</span><span class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">tick_labels</span><span class=\"ansi-yellow-bg\">,</span><span class=\"ansi-yellow-bg\"> </span><span class=\"ansi-yellow-bg\">autorange</span><span class=\"ansi-yellow-bg\">=</span><span class=\"ansi-yellow-bg\">autorange</span><span class=\"ansi-yellow-bg\">)</span>\n<span class=\"ansi-green-fg\">   4140</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">if</span> notch <span style=\"font-weight:bold;color:rgb(175,0,255)\">is</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">None</span>:\n<span class=\"ansi-green-fg\">   4141</span>     notch = mpl.rcParams[<span class=\"ansi-yellow-fg\">'</span><span class=\"ansi-yellow-fg\">boxplot.notch</span><span class=\"ansi-yellow-fg\">'</span>]\n\n<span class=\"ansi-cyan-fg\">File </span><span class=\"ansi-green-fg\">~/miniforge3/envs/climada/lib/python3.11/site-packages/matplotlib/cbook.py:1217</span>, in <span class=\"ansi-cyan-fg\">boxplot_stats</span><span class=\"ansi-blue-fg\">(X, whis, bootstrap, labels, autorange)</span>\n<span class=\"ansi-green-fg\">   1215</span>     labels = itertools.repeat(<span style=\"font-weight:bold;color:rgb(0,135,0)\">None</span>)\n<span class=\"ansi-green-fg\">   1216</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">elif</span> <span style=\"color:rgb(0,135,0)\">len</span>(labels) != ncols:\n<span class=\"ansi-green-fg\">-&gt; </span><span class=\"ansi-green-fg\">1217</span>     <span style=\"font-weight:bold;color:rgb(0,135,0)\">raise</span> <span style=\"font-weight:bold;color:rgb(215,95,95)\">ValueError</span>(<span class=\"ansi-yellow-fg\">\"</span><span class=\"ansi-yellow-fg\">Dimensions of labels and X must be compatible</span><span class=\"ansi-yellow-fg\">\"</span>)\n<span class=\"ansi-green-fg\">   1219</span> input_whis = whis\n<span class=\"ansi-green-fg\">   1220</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">for</span> ii, (x, label) <span style=\"font-weight:bold;color:rgb(175,0,255)\">in</span> <span style=\"color:rgb(0,135,0)\">enumerate</span>(<span style=\"color:rgb(0,135,0)\">zip</span>(X, labels)):\n<span class=\"ansi-green-fg\">   1221</span> \n<span class=\"ansi-green-fg\">   1222</span>     <span style=\"font-style:italic;color:rgb(95,135,135)\"># empty dict</span>\n\n<span class=\"ansi-red-fg\">ValueError</span>: Dimensions of labels and X must be compatible</pre>\n```\n:::\n\n:::\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-8-output-2.png){width=1126 height=451}\n:::\n:::\n\n\n### Summary and Insights\n\n::: {#49b5398d .cell execution_count=8}\n``` {.python .cell-code}\n# Generate comprehensive summary\nprint(\"=\" * 70)\nprint(\"CLIMATE EXTREMES ANALYSIS SUMMARY\")\nprint(\"=\" * 70)\n\nprint(f\"\\nüìä Dataset Overview:\")\nprint(f\"   Period: {climate_data['datetime_utc'].min().date()} to {climate_data['datetime_utc'].max().date()}\")\nprint(f\"   Total days: {len(climate_data):,}\")\nprint(f\"   Variables: Temperature, Precipitation, Pressure\")\n\nprint(f\"\\nüå°Ô∏è  Temperature Extremes:\")\nprint(f\"   Total extreme events: {temp_stats['n_events']}\")\nprint(f\"   Extreme days: {temp_stats['total_days']} ({100*temp_stats['total_days']/len(climate_data):.2f}% of period)\")\nprint(f\"   Mean intensity: {temp_stats['mean_intensity']:.2f}¬∞C above 95th percentile\")\nprint(f\"   Maximum intensity: {temp_stats['max_intensity']:.2f}¬∞C above threshold\")\nprint(f\"   Mean duration: {temp_stats['mean_duration']:.1f} days per event\")\n\nprint(f\"\\nüåßÔ∏è  Precipitation Extremes:\")\nprint(f\"   Total extreme events: {precip_stats['n_events']}\")\nprint(f\"   Extreme days: {precip_stats['total_days']} ({100*precip_stats['total_days']/len(climate_data):.2f}% of period)\")\nprint(f\"   Mean intensity: {precip_stats['mean_intensity']:.2f} mm above 95th percentile\")\nprint(f\"   Maximum intensity: {precip_stats['max_intensity']:.2f} mm above threshold\")\n\nprint(f\"\\nüìà Return Period Analysis:\")\nprint(f\"   100-year return temperature: {return_periods_temp[return_periods_temp['return_period_years']==100]['return_value'].values[0]:.2f}¬∞C\")\nprint(f\"   100-year return precipitation: {return_periods_precip[return_periods_precip['return_period_years']==100]['return_value'].values[0]:.2f} mm\")\n\nprint(f\"\\nüîó Variable Correlations:\")\nprint(f\"   Temperature-Precipitation: {corr_matrix.loc['temperature_c', 'precipitation_mm']:.3f}\")\nprint(f\"   Temperature-Pressure: {corr_matrix.loc['temperature_c', 'pressure_hpa']:.3f}\")\nprint(f\"   Precipitation-Pressure: {corr_matrix.loc['precipitation_mm', 'pressure_hpa']:.3f}\")\n\nprint(f\"\\nüéØ Extreme Event Clusters:\")\nprint(f\"   Number of clusters: {climate_data['extreme_cluster'].max()}\")\nfor cluster_id in sorted(cluster_stats['extreme_cluster']):\n    cluster_data = climate_data[climate_data['extreme_cluster'] == cluster_id]\n    print(f\"   Cluster {cluster_id}: {len(cluster_data)} events, \"\n          f\"mean temp {cluster_stats[cluster_stats['extreme_cluster']==cluster_id]['temperature_c'].values[0]:.1f}¬∞C\")\n\nprint(\"\\n\" + \"=\" * 70)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n======================================================================\nCLIMATE EXTREMES ANALYSIS SUMMARY\n======================================================================\n\nüìä Dataset Overview:\n   Period: 2000-01-01 to 2023-12-31\n   Total days: 8,766\n   Variables: Temperature, Precipitation, Pressure\n\nüå°Ô∏è  Temperature Extremes:\n   Total extreme events: 399\n   Extreme days: 439 (5.01% of period)\n   Mean intensity: 8.34¬∞C above 95th percentile\n   Maximum intensity: 304.83¬∞C above threshold\n   Mean duration: 1.1 days per event\n\nüåßÔ∏è  Precipitation Extremes:\n   Total extreme events: 399\n   Extreme days: 439 (5.01% of period)\n   Mean intensity: 8.34 mm above 95th percentile\n   Maximum intensity: 304.83 mm above threshold\n\nüìà Return Period Analysis:\n   100-year return temperature: 54.22¬∞C\n   100-year return precipitation: 20.05 mm\n\nüîó Variable Correlations:\n   Temperature-Precipitation: -0.196\n   Temperature-Pressure: -0.662\n   Precipitation-Pressure: 0.140\n\nüéØ Extreme Event Clusters:\n   Number of clusters: 5\n   Cluster 1: 223 events, mean temp 5.5¬∞C\n   Cluster 2: 4 events, mean temp 6.0¬∞C\n   Cluster 3: 28 events, mean temp 26.1¬∞C\n   Cluster 4: 21 events, mean temp 12.7¬∞C\n   Cluster 5: 163 events, mean temp 12.6¬∞C\n\n======================================================================\n```\n:::\n:::\n\n\n---\n\n**Note:** This analysis uses synthetic climate data for demonstration. In production, this framework can be applied to real ERA5 reanalysis data or observational climate datasets. The methods shown here‚Äîextreme value theory, return period analysis, and event clustering‚Äîare standard approaches in climate risk assessment.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}