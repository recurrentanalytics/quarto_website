{
  "hash": "78b1ecc0b57cb37286081192f58f00e5",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Climate Extremes Explorer\"\ndate: 2025-12-15\ncategories: [climate, extremes, analysis, visualization]\ndescription: \"Comprehensive interactive analysis of climate extremes using synthetic climate data. Demonstrates methods for identifying, analyzing, and visualizing extreme climate events including heatwaves, cold snaps, and extreme precipitation. Features return period analysis, event clustering, and multi-variable correlation analysis.\"\nexecute:\n  echo: true\n  warning: false\n  message: false\nfreeze: auto\n---\n\n## Overview\n\nExtreme climate events‚Äîheatwaves, cold snaps, extreme precipitation‚Äîare not anomalies to be dismissed as outliers. They are the signal. Understanding their frequency, intensity, and co-occurrence patterns is fundamental to climate risk assessment. This analysis applies extreme value theory and multivariate statistics to extract structure from what appears chaotic.\n\nThe framework demonstrates:\n\n- **Extreme Event Identification** - Multiple methods (percentile, absolute, anomaly)\n- **Return Period Analysis** - Extreme value theory (Block Maxima, Peaks Over Threshold)\n- **Multi-Variable Correlation** - Relationships between climate variables\n- **Event Clustering** - Hierarchical clustering of extreme events\n- **Statistical Analysis** - Comprehensive extreme event statistics\n\n## Building the Foundation: Synthetic Climate Data\n\nBefore we can identify extremes, we need a baseline. Synthetic data generation here serves two purposes: it provides a controlled environment to test methods, and it demonstrates how realistic climate variability can emerge from relatively simple stochastic processes. The data spans 24 years (2000-2023) with daily resolution, capturing temperature, precipitation, and atmospheric pressure‚Äîthree variables that interact in complex ways.\n\nThe synthetic generation incorporates:\n- **Seasonal cycles** (annual temperature variation, precipitation patterns)\n- **Inter-annual variability** (year-to-year fluctuations)\n- **Cross-variable dependencies** (temperature-precipitation relationships)\n- **Autocorrelation** (weather persistence over days)\n\nThis isn't \"fake data\" in the pejorative sense‚Äîit's a generative model that captures the statistical structure of real climate systems. When we later identify extremes, we're finding events that would be rare under this baseline distribution.\n\n### Generate and Load Climate Data\n\n::: {#ff8eb08f .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\ntry:\n    import seaborn as sns\n    HAS_SEABORN = True\nexcept ImportError:\n    HAS_SEABORN = False\n    print(\"Note: seaborn not available, using matplotlib for heatmap\")\nfrom scipy import stats\n\nfrom src.climate_extremes import (\n    generate_synthetic_climate_data,\n    identify_extremes,\n    compute_return_periods,\n    analyze_correlations,\n    cluster_extreme_events,\n    compute_extreme_statistics,\n)\n\n# Generate synthetic climate data (2000-2023, daily)\nprint(\"Generating synthetic climate data...\")\nclimate_data = generate_synthetic_climate_data(\n    start_date=\"2000-01-01\",\n    end_date=\"2023-12-31\",\n    freq=\"D\",\n    seed=42\n)\n\nprint(f\"\\nData shape: {climate_data.shape}\")\nprint(f\"Date range: {climate_data['datetime_utc'].min()} to {climate_data['datetime_utc'].max()}\")\nprint(\"\\nFirst few rows:\")\nprint(climate_data.head())\nprint(\"\\nSummary statistics:\")\nprint(climate_data[['temperature_c', 'precipitation_mm', 'pressure_hpa']].describe())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nGenerating synthetic climate data...\n\nData shape: (8766, 4)\nDate range: 2000-01-01 00:00:00+00:00 to 2023-12-31 00:00:00+00:00\n\nFirst few rows:\n               datetime_utc  temperature_c  precipitation_mm  pressure_hpa\n0 2000-01-01 00:00:00+00:00      16.490142          1.987423   1016.294377\n1 2000-01-02 00:00:00+00:00      14.757278          3.775058   1017.524657\n2 2000-01-03 00:00:00+00:00      17.287156          3.904062   1009.176811\n3 2000-01-04 00:00:00+00:00      20.085098          6.355532    999.046500\n4 2000-01-05 00:00:00+00:00      14.985313          0.236418   1014.740259\n\nSummary statistics:\n       temperature_c  precipitation_mm  pressure_hpa\ncount    8766.000000       8766.000000   8766.000000\nmean       15.773961          4.322842   1013.243240\nstd         8.838041          6.592951      6.677491\nmin       -19.483457          0.026432    985.935802\n25%         8.700376          1.648959   1008.784265\n50%        15.748301          3.060113   1013.282316\n75%        22.461284          5.356232   1017.790731\nmax        56.866253        316.088010   1039.191900\n```\n:::\n:::\n\n\n## Defining the Extreme: Operational Thresholds\n\nWhat counts as \"extreme\" is not a question with a single answer. It's a modeling choice with real consequences. We use the 95th percentile threshold‚Äîmeaning 5% of days exceed this value‚Äîbut this is arbitrary. A heatwave that's extreme in one region might be normal in another. A 3-day minimum duration filters out single-day spikes, focusing on sustained events that have greater impact.\n\nThe choice of method matters:\n- **Percentile-based**: Relative to the local distribution (adapts to regional climate)\n- **Absolute thresholds**: Fixed values (e.g., 30¬∞C) that ignore local context\n- **Anomaly-based**: Deviations from expected seasonal patterns\n\nHere, we use percentile thresholds because they're scale-invariant and adapt to the data's inherent variability. A 95th percentile heatwave in a temperate region might be 28¬∞C, while in a desert it might be 42¬∞C‚Äîboth are equally \"extreme\" relative to their contexts.\n\n### Identify Extreme Events\n\n::: {#457924e8 .cell execution_count=2}\n``` {.python .cell-code}\n# Identify extreme temperature events (95th percentile, minimum 3 consecutive days)\nclimate_data = identify_extremes(\n    climate_data,\n    variable='temperature_c',\n    method='percentile',\n    threshold=95.0,\n    min_duration=3\n)\n\n# Also identify extreme precipitation events\nclimate_data = identify_extremes(\n    climate_data,\n    variable='precipitation_mm',\n    method='percentile',\n    threshold=95.0,\n    min_duration=1\n)\n\n# Compute statistics\ntemp_stats = compute_extreme_statistics(climate_data, 'temperature_c')\nprecip_stats = compute_extreme_statistics(climate_data, 'precipitation_mm')\n\nprint(\"Temperature Extreme Events:\")\nprint(f\"  Number of events: {temp_stats['n_events']}\")\nprint(f\"  Total extreme days: {temp_stats['total_days']}\")\nprint(f\"  Mean intensity: {temp_stats['mean_intensity']:.2f}¬∞C above threshold\")\nprint(f\"  Maximum intensity: {temp_stats['max_intensity']:.2f}¬∞C above threshold\")\nprint(f\"  Mean duration: {temp_stats['mean_duration']:.1f} days\")\n\nprint(\"\\nPrecipitation Extreme Events:\")\nprint(f\"  Number of events: {precip_stats['n_events']}\")\nprint(f\"  Total extreme days: {precip_stats['total_days']}\")\nprint(f\"  Mean intensity: {precip_stats['mean_intensity']:.2f} mm above threshold\")\nprint(f\"  Maximum intensity: {precip_stats['max_intensity']:.2f} mm above threshold\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nTemperature Extreme Events:\n  Number of events: 399\n  Total extreme days: 439\n  Mean intensity: 8.34¬∞C above threshold\n  Maximum intensity: 304.83¬∞C above threshold\n  Mean duration: 1.1 days\n\nPrecipitation Extreme Events:\n  Number of events: 399\n  Total extreme days: 439\n  Mean intensity: 8.34 mm above threshold\n  Maximum intensity: 304.83 mm above threshold\n```\n:::\n:::\n\n\n## Temporal Patterns: When Extremes Occur\n\nThe timeline visualization reveals something crucial: extreme events are not uniformly distributed. They cluster in time, creating periods of elevated risk. The temperature extremes show clear seasonal patterns‚Äîheatwaves in summer, cold snaps in winter‚Äîbut also reveal inter-annual variability. Some years are quiet; others are punctuated by multiple extreme events.\n\nThis temporal clustering has implications for risk assessment. If extremes were independent random events, we could model them with simple Poisson processes. But they're not. They exhibit persistence (heatwaves last multiple days) and clustering (extreme years contain multiple extreme events). This means risk is not constant‚Äîit's time-varying and state-dependent.\n\nThe visualization also shows the relationship between variables. Notice how extreme precipitation events sometimes coincide with temperature extremes (convective storms during heatwaves), and sometimes don't (frontal systems during cooler periods). This co-occurrence‚Äîor lack thereof‚Äîmatters for compound risk assessment.\n\n::: {#8460fe54 .cell execution_count=3}\n``` {.python .cell-code}\n# Create timeline visualization with extreme events highlighted\nfig, axes = plt.subplots(3, 1, figsize=(14, 10), sharex=True)\n\n# Temperature with extreme events\nax1 = axes[0]\nax1.plot(climate_data['datetime_utc'], climate_data['temperature_c'], \n         color='#2c3e50', alpha=0.6, linewidth=0.8, label='Temperature')\nax1.scatter(climate_data[climate_data['is_extreme']]['datetime_utc'],\n           climate_data[climate_data['is_extreme']]['temperature_c'],\n           c='#e74c3c', s=30, alpha=0.7, label='Extreme Events', zorder=5)\nax1.axhline(y=np.percentile(climate_data['temperature_c'], 95), \n           color='#c0392b', linestyle='--', alpha=0.7, label='95th Percentile')\nax1.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature Time Series with Extreme Events Highlighted', \n              fontsize=13, fontweight='bold', pad=10)\nax1.legend(loc='upper left', fontsize=9)\nax1.grid(True, alpha=0.3)\n\n# Precipitation with extreme events\nax2 = axes[1]\nax2.plot(climate_data['datetime_utc'], climate_data['precipitation_mm'], \n         color='#3498db', alpha=0.6, linewidth=0.8, label='Precipitation')\nprecip_extremes = climate_data[climate_data['precipitation_mm'] >= \n                               np.percentile(climate_data['precipitation_mm'], 95)]\nax2.scatter(precip_extremes['datetime_utc'], precip_extremes['precipitation_mm'],\n           c='#2980b9', s=30, alpha=0.7, label='Extreme Events', zorder=5)\nax2.axhline(y=np.percentile(climate_data['precipitation_mm'], 95), \n           color='#21618c', linestyle='--', alpha=0.7, label='95th Percentile')\nax2.set_ylabel('Precipitation (mm)', fontsize=11, fontweight='bold')\nax2.set_title('Precipitation Time Series with Extreme Events Highlighted', \n              fontsize=13, fontweight='bold', pad=10)\nax2.legend(loc='upper left', fontsize=9)\nax2.grid(True, alpha=0.3)\n\n# Pressure\nax3 = axes[2]\nax3.plot(climate_data['datetime_utc'], climate_data['pressure_hpa'], \n         color='#7f8c8d', alpha=0.6, linewidth=0.8)\nax3.set_ylabel('Pressure (hPa)', fontsize=11, fontweight='bold')\nax3.set_xlabel('Date', fontsize=11, fontweight='bold')\nax3.set_title('Atmospheric Pressure Time Series', \n              fontsize=13, fontweight='bold', pad=10)\nax3.grid(True, alpha=0.3)\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](climate-extremes-explorer_files/figure-html/cell-4-output-1.png){width=1335 height=949}\n:::\n:::\n\n\n## Return Periods: Quantifying Rarity\n\nReturn period analysis answers a deceptively simple question: \"How often should we expect an event of this magnitude?\" A 100-year return period doesn't mean it happens exactly once per century‚Äîit means the annual probability is 1%. Over a 100-year period, there's a 63% chance of experiencing at least one such event (due to the compounding of probabilities).\n\nThe two methods shown here capture different aspects of extremes:\n- **Block Maxima (Annual Maxima)**: Takes the maximum value each year, fits a Generalized Extreme Value (GEV) distribution. Good for understanding the worst-case scenario in any given year.\n- **Peaks Over Threshold**: Identifies all values above a threshold, fits a Generalized Pareto Distribution (GPD). More data-efficient, captures multiple extremes per year.\n\nThe log-scale x-axis is intentional. Return periods follow a power-law relationship‚Äîdoubling the return period doesn't double the intensity. The curve flattens, meaning truly catastrophic events (1000-year return periods) are only marginally more intense than 100-year events, but exponentially rarer.\n\nThis analysis is the foundation of engineering design standards (dams, bridges, flood defenses) and insurance pricing. The \"100-year flood\" isn't a prediction‚Äîit's a risk metric.\n\n::: {#97a75652 .cell execution_count=4}\n``` {.python .cell-code}\n# Compute return periods for temperature extremes\nreturn_periods_temp = compute_return_periods(\n    climate_data,\n    variable='temperature_c',\n    method='block_maxima',\n    block_size='1Y'\n)\n\nreturn_periods_precip = compute_return_periods(\n    climate_data,\n    variable='precipitation_mm',\n    method='peaks_over_threshold',\n)\n\nfig, axes = plt.subplots(1, 2, figsize=(14, 5))\n\n# Temperature return periods\nax1 = axes[0]\nax1.plot(return_periods_temp['return_period_years'], \n        return_periods_temp['return_value'], \n        marker='o', linewidth=2, markersize=8, color='#e74c3c')\nax1.set_xlabel('Return Period (years)', fontsize=11, fontweight='bold')\nax1.set_ylabel('Return Value (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature: Return Period Analysis\\n(Annual Maxima Method)', \n              fontsize=12, fontweight='bold')\nax1.grid(True, alpha=0.3)\nax1.set_xscale('log')\n\n# Precipitation return periods\nax2 = axes[1]\nax2.plot(return_periods_precip['return_period_years'], \n        return_periods_precip['return_value'], \n        marker='o', linewidth=2, markersize=8, color='#3498db')\nax2.set_xlabel('Return Period (years)', fontsize=11, fontweight='bold')\nax2.set_ylabel('Return Value (mm)', fontsize=11, fontweight='bold')\nax2.set_title('Precipitation: Return Period Analysis\\n(Peaks Over Threshold Method)', \n              fontsize=12, fontweight='bold')\nax2.grid(True, alpha=0.3)\nax2.set_xscale('log')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"Return Period Analysis Results:\")\nprint(\"\\nTemperature (Annual Maxima):\")\nprint(return_periods_temp.to_string(index=False))\nprint(\"\\nPrecipitation (Peaks Over Threshold):\")\nprint(return_periods_precip.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-display}\n![](climate-extremes-explorer_files/figure-html/cell-5-output-1.png){width=1335 height=469}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nReturn Period Analysis Results:\n\nTemperature (Annual Maxima):\n return_period_years  return_value      variable\n                   2     42.794460 temperature_c\n                   5     47.875623 temperature_c\n                  10     50.035892 temperature_c\n                  20     51.623194 temperature_c\n                  50     53.232872 temperature_c\n                 100     54.216806 temperature_c\n                 200     55.062521 temperature_c\n                 500     56.024671 temperature_c\n\nPrecipitation (Peaks Over Threshold):\n return_period_years  return_value         variable\n                   2           NaN precipitation_mm\n                   5           NaN precipitation_mm\n                  10           NaN precipitation_mm\n                  20     11.267369 precipitation_mm\n                  50     15.124830 precipitation_mm\n                 100     20.049680 precipitation_mm\n                 200     27.822761 precipitation_mm\n                 500     45.390184 precipitation_mm\n```\n:::\n:::\n\n\n## Correlation Structure: When Variables Move Together\n\nClimate variables don't exist in isolation. Temperature, precipitation, and pressure are coupled through physical processes. The correlation matrix quantifies these relationships, but the interpretation requires care.\n\nA negative correlation between temperature and precipitation might seem counterintuitive, but it reflects the physics: high-pressure systems (clear skies, high temperatures) suppress precipitation, while low-pressure systems (clouds, precipitation) moderate temperatures. The strength of these correlations varies by season and region.\n\nWhy this matters: if variables are correlated, extreme events in one variable are more likely to co-occur with extremes in another. This creates compound risks that simple univariate analysis misses. A heatwave coinciding with low precipitation creates drought stress. A cold snap with high precipitation creates ice storms. The correlation structure tells us which compound events are physically plausible and which are unlikely.\n\n::: {#2d1250fa .cell execution_count=5}\n``` {.python .cell-code}\n# Compute correlation matrix\ncorr_matrix = analyze_correlations(\n    climate_data,\n    variables=['temperature_c', 'precipitation_mm', 'pressure_hpa']\n)\n\n# Create heatmap\nfig, ax = plt.subplots(figsize=(8, 6))\nif HAS_SEABORN:\n    sns.heatmap(corr_matrix, annot=True, fmt='.3f', cmap='RdBu_r', center=0,\n               square=True, linewidths=1, cbar_kws={\"shrink\": 0.8},\n               vmin=-1, vmax=1, ax=ax)\nelse:\n    im = ax.imshow(corr_matrix.values, cmap='RdBu_r', vmin=-1, vmax=1, aspect='auto')\n    ax.set_xticks(range(len(corr_matrix.columns)))\n    ax.set_yticks(range(len(corr_matrix.index)))\n    ax.set_xticklabels(corr_matrix.columns)\n    ax.set_yticklabels(corr_matrix.index)\n    for i in range(len(corr_matrix.index)):\n        for j in range(len(corr_matrix.columns)):\n            ax.text(j, i, f'{corr_matrix.iloc[i, j]:.3f}', \n                   ha='center', va='center', color='black' if abs(corr_matrix.iloc[i, j]) < 0.5 else 'white')\n    plt.colorbar(im, ax=ax, shrink=0.8)\nax.set_title('Climate Variables Correlation Matrix', \n             fontsize=13, fontweight='bold', pad=15)\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nCorrelation Matrix:\")\nprint(corr_matrix)\n```\n\n::: {.cell-output .cell-output-display}\n![](climate-extremes-explorer_files/figure-html/cell-6-output-1.png){width=638 height=565}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCorrelation Matrix:\n                  temperature_c  precipitation_mm  pressure_hpa\ntemperature_c          1.000000         -0.196128     -0.661777\nprecipitation_mm      -0.196128          1.000000      0.139706\npressure_hpa          -0.661777          0.139706      1.000000\n```\n:::\n:::\n\n\n## Event Typology: Clustering Extreme Events\n\nNot all extreme events are the same. Hierarchical clustering groups events by their multi-variable signatures, revealing distinct \"types\" of extremes. One cluster might represent \"dry heatwaves\" (high temperature, low precipitation, high pressure), while another represents \"humid heatwaves\" (high temperature, high precipitation, low pressure).\n\nThis typology matters because different event types have different impacts. A dry heatwave increases wildfire risk and water stress. A humid heatwave increases heat stress on humans (reduced evaporative cooling) and can trigger convective storms. The clustering analysis transforms a collection of individual events into a taxonomy of risk scenarios.\n\nThe cluster characteristics plot shows the mean conditions for each event type. Notice how clusters differ not just in temperature, but in the full multi-variable space. This is the power of multivariate analysis: it captures patterns that univariate methods miss.\n\n::: {#fae5d764 .cell execution_count=6}\n``` {.python .cell-code}\n# Cluster extreme temperature events\nclimate_data = cluster_extreme_events(\n    climate_data,\n    n_clusters=5,\n    variables=['temperature_c', 'precipitation_mm', 'pressure_hpa']\n)\n\n# Visualize clustered extreme events\nfig, axes = plt.subplots(2, 1, figsize=(14, 10), sharex=True)\n\n# Temperature with cluster colors\nax1 = axes[0]\nscatter = ax1.scatter(climate_data['datetime_utc'], climate_data['temperature_c'],\n                     c=climate_data['extreme_cluster'], cmap='Set1', \n                     s=20, alpha=0.6, edgecolors='black', linewidth=0.5)\nextreme_mask = climate_data['is_extreme']\nax1.scatter(climate_data[extreme_mask]['datetime_utc'],\n           climate_data[extreme_mask]['temperature_c'],\n           c=climate_data[extreme_mask]['extreme_cluster'], cmap='Set1',\n           s=100, alpha=0.9, edgecolors='black', linewidth=1.5, \n           marker='*', zorder=5, label='Extreme Events')\nax1.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold')\nax1.set_title('Temperature Time Series with Clustered Extreme Events', \n              fontsize=13, fontweight='bold', pad=10)\ncbar = plt.colorbar(scatter, ax=ax1)\ncbar.set_label('Cluster ID', fontsize=10)\nax1.legend(loc='upper left', fontsize=9)\nax1.grid(True, alpha=0.3)\n\n# Cluster characteristics\nax2 = axes[1]\ncluster_stats = climate_data[climate_data['extreme_cluster'] > 0].groupby('extreme_cluster').agg({\n    'temperature_c': 'mean',\n    'precipitation_mm': 'mean',\n    'pressure_hpa': 'mean',\n    'extreme_intensity': 'mean',\n}).reset_index()\n\nx_pos = np.arange(len(cluster_stats))\nwidth = 0.35\nax2.bar(x_pos - width/2, cluster_stats['temperature_c'], width, \n       label='Temperature', color='#e74c3c', alpha=0.7)\nax2_twin = ax2.twinx()\nax2_twin.bar(x_pos + width/2, cluster_stats['precipitation_mm'], width,\n            label='Precipitation', color='#3498db', alpha=0.7)\nax2.set_xlabel('Cluster ID', fontsize=11, fontweight='bold')\nax2.set_ylabel('Temperature (¬∞C)', fontsize=11, fontweight='bold', color='#e74c3c')\nax2_twin.set_ylabel('Precipitation (mm)', fontsize=11, fontweight='bold', color='#3498db')\nax2.set_title('Cluster Characteristics: Mean Values by Cluster', \n              fontsize=13, fontweight='bold', pad=10)\nax2.set_xticks(x_pos)\nax2.set_xticklabels(cluster_stats['extreme_cluster'])\nax2.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nCluster Statistics:\")\nprint(cluster_stats.to_string(index=False))\n```\n\n::: {.cell-output .cell-output-display}\n![](climate-extremes-explorer_files/figure-html/cell-7-output-1.png){width=1335 height=949}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCluster Statistics:\n extreme_cluster  temperature_c  precipitation_mm  pressure_hpa  extreme_intensity\n               1       5.499854         14.701148   1020.549791           3.438765\n               2       5.956776        200.997156   1021.397432         189.734773\n               3      26.091330         16.614513   1006.965570           5.352129\n               4      12.662559         63.720836   1017.063492          52.458453\n               5      12.641321         16.681648   1011.837337           5.419265\n```\n:::\n:::\n\n\n## Intensity Distribution: The Shape of Extremes\n\nThe distribution of extreme event intensities reveals something important: extremes themselves have structure. They're not uniformly distributed‚Äîthere are \"moderate extremes\" and \"extreme extremes.\" The histogram shows a right-skewed distribution, meaning most extreme events are relatively mild (just above the threshold), while truly catastrophic events are rare.\n\nThe box plots by cluster show that different event types have different intensity distributions. Some clusters have tight distributions (consistent intensity), while others are highly variable. This heterogeneity matters for risk assessment: if you're planning for the \"typical extreme,\" you'll be underprepared for the tail events.\n\nThe median being lower than the mean indicates positive skew‚Äîthe distribution has a long right tail. This is characteristic of extreme value distributions and reflects the physics: there's a lower bound (you can't have negative heat), but no upper bound (temperatures can theoretically get arbitrarily high, though practically limited by energy balance).\n\n::: {#29e473d3 .cell execution_count=7}\n``` {.python .cell-code}\n# Analyze distribution of extreme event intensities\nextreme_events = climate_data[climate_data['is_extreme']].copy()\n\nfig, axes = plt.subplots(1, 2, figsize=(14, 5))\n\n# Histogram of extreme intensities\nax1 = axes[0]\nax1.hist(extreme_events['extreme_intensity'], bins=30, color='#e74c3c', \n        alpha=0.7, edgecolor='black', linewidth=1.2)\nax1.axvline(extreme_events['extreme_intensity'].mean(), \n           color='#c0392b', linestyle='--', linewidth=2, \n           label=f\"Mean: {extreme_events['extreme_intensity'].mean():.2f}¬∞C\")\nax1.axvline(extreme_events['extreme_intensity'].median(), \n           color='#8e44ad', linestyle='--', linewidth=2,\n           label=f\"Median: {extreme_events['extreme_intensity'].median():.2f}¬∞C\")\nax1.set_xlabel('Extreme Intensity (¬∞C above threshold)', fontsize=11, fontweight='bold')\nax1.set_ylabel('Frequency', fontsize=11, fontweight='bold')\nax1.set_title('Distribution of Extreme Event Intensities', \n              fontsize=12, fontweight='bold')\nax1.legend(fontsize=9)\nax1.grid(True, alpha=0.3, axis='y')\n\n# Box plot by cluster\nax2 = axes[1]\n# Get unique cluster IDs (excluding 0) and filter out empty clusters\nunique_clusters = sorted([i for i in extreme_events['extreme_cluster'].unique() if i > 0])\ncluster_data = []\ncluster_labels = []\nfor i in unique_clusters:\n    data = extreme_events[extreme_events['extreme_cluster'] == i]['extreme_intensity'].values\n    if len(data) > 0:  # Only include clusters with data\n        cluster_data.append(data)\n        cluster_labels.append(str(i))\n\n# Only plot if we have data\nif len(cluster_data) > 0:\n    bp = ax2.boxplot(cluster_data, labels=cluster_labels,\n                    patch_artist=True, showmeans=True)\n    for patch in bp['boxes']:\n        patch.set_facecolor('#e74c3c')\n        patch.set_alpha(0.7)\nelse:\n    ax2.text(0.5, 0.5, 'No cluster data available', \n            ha='center', va='center', transform=ax2.transAxes)\nax2.set_xlabel('Cluster ID', fontsize=11, fontweight='bold')\nax2.set_ylabel('Extreme Intensity (¬∞C above threshold)', fontsize=11, fontweight='bold')\nax2.set_title('Extreme Intensity Distribution by Cluster', \n              fontsize=12, fontweight='bold')\nax2.grid(True, alpha=0.3, axis='y')\n\nplt.tight_layout()\nplt.show()\n\nprint(\"\\nExtreme Event Intensity Statistics:\")\nprint(extreme_events['extreme_intensity'].describe())\n```\n\n::: {.cell-output .cell-output-display}\n![](climate-extremes-explorer_files/figure-html/cell-8-output-1.png){width=1335 height=470}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nExtreme Event Intensity Statistics:\ncount    439.000000\nmean       8.338522\nstd       22.503147\nmin        0.000094\n25%        1.083130\n50%        2.890158\n75%        5.935226\nmax      304.825627\nName: extreme_intensity, dtype: float64\n```\n:::\n:::\n\n\n## Synthesis: What the Numbers Tell Us\n\nThe summary statistics aggregate the analysis into digestible metrics, but the real insights come from understanding how these pieces fit together. The return period analysis tells us about rarity. The clustering tells us about diversity. The correlation structure tells us about co-occurrence. Together, they paint a picture of a climate system where extremes are:\n\n1. **Rare but not random**: They follow statistical distributions that can be modeled\n2. **Diverse in type**: Not all extremes are the same‚Äîdifferent event types have different impacts\n3. **Correlated in space and time**: Variables move together, creating compound risks\n4. **Heterogeneous in intensity**: Most extremes are moderate; catastrophic events are exponentially rarer\n\nThis framework is the foundation for climate risk assessment. It transforms raw data into actionable intelligence: understanding not just what happened, but what could happen, how often, and in what combinations.\n\n::: {#561292bc .cell execution_count=8}\n``` {.python .cell-code}\n# Generate comprehensive summary\nprint(\"=\" * 70)\nprint(\"CLIMATE EXTREMES ANALYSIS SUMMARY\")\nprint(\"=\" * 70)\n\nprint(f\"\\nüìä Dataset Overview:\")\nprint(f\"   Period: {climate_data['datetime_utc'].min().date()} to {climate_data['datetime_utc'].max().date()}\")\nprint(f\"   Total days: {len(climate_data):,}\")\nprint(f\"   Variables: Temperature, Precipitation, Pressure\")\n\nprint(f\"\\nüå°Ô∏è  Temperature Extremes:\")\nprint(f\"   Total extreme events: {temp_stats['n_events']}\")\nprint(f\"   Extreme days: {temp_stats['total_days']} ({100*temp_stats['total_days']/len(climate_data):.2f}% of period)\")\nprint(f\"   Mean intensity: {temp_stats['mean_intensity']:.2f}¬∞C above 95th percentile\")\nprint(f\"   Maximum intensity: {temp_stats['max_intensity']:.2f}¬∞C above threshold\")\nprint(f\"   Mean duration: {temp_stats['mean_duration']:.1f} days per event\")\n\nprint(f\"\\nüåßÔ∏è  Precipitation Extremes:\")\nprint(f\"   Total extreme events: {precip_stats['n_events']}\")\nprint(f\"   Extreme days: {precip_stats['total_days']} ({100*precip_stats['total_days']/len(climate_data):.2f}% of period)\")\nprint(f\"   Mean intensity: {precip_stats['mean_intensity']:.2f} mm above 95th percentile\")\nprint(f\"   Maximum intensity: {precip_stats['max_intensity']:.2f} mm above threshold\")\n\nprint(f\"\\nüìà Return Period Analysis:\")\nprint(f\"   100-year return temperature: {return_periods_temp[return_periods_temp['return_period_years']==100]['return_value'].values[0]:.2f}¬∞C\")\nprint(f\"   100-year return precipitation: {return_periods_precip[return_periods_precip['return_period_years']==100]['return_value'].values[0]:.2f} mm\")\n\nprint(f\"\\nüîó Variable Correlations:\")\nprint(f\"   Temperature-Precipitation: {corr_matrix.loc['temperature_c', 'precipitation_mm']:.3f}\")\nprint(f\"   Temperature-Pressure: {corr_matrix.loc['temperature_c', 'pressure_hpa']:.3f}\")\nprint(f\"   Precipitation-Pressure: {corr_matrix.loc['precipitation_mm', 'pressure_hpa']:.3f}\")\n\nprint(f\"\\nüéØ Extreme Event Clusters:\")\nprint(f\"   Number of clusters: {climate_data['extreme_cluster'].max()}\")\nfor cluster_id in sorted(cluster_stats['extreme_cluster']):\n    cluster_data = climate_data[climate_data['extreme_cluster'] == cluster_id]\n    print(f\"   Cluster {cluster_id}: {len(cluster_data)} events, \"\n          f\"mean temp {cluster_stats[cluster_stats['extreme_cluster']==cluster_id]['temperature_c'].values[0]:.1f}¬∞C\")\n\nprint(\"\\n\" + \"=\" * 70)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n======================================================================\nCLIMATE EXTREMES ANALYSIS SUMMARY\n======================================================================\n\nüìä Dataset Overview:\n   Period: 2000-01-01 to 2023-12-31\n   Total days: 8,766\n   Variables: Temperature, Precipitation, Pressure\n\nüå°Ô∏è  Temperature Extremes:\n   Total extreme events: 399\n   Extreme days: 439 (5.01% of period)\n   Mean intensity: 8.34¬∞C above 95th percentile\n   Maximum intensity: 304.83¬∞C above threshold\n   Mean duration: 1.1 days per event\n\nüåßÔ∏è  Precipitation Extremes:\n   Total extreme events: 399\n   Extreme days: 439 (5.01% of period)\n   Mean intensity: 8.34 mm above 95th percentile\n   Maximum intensity: 304.83 mm above threshold\n\nüìà Return Period Analysis:\n   100-year return temperature: 54.22¬∞C\n   100-year return precipitation: 20.05 mm\n\nüîó Variable Correlations:\n   Temperature-Precipitation: -0.196\n   Temperature-Pressure: -0.662\n   Precipitation-Pressure: 0.140\n\nüéØ Extreme Event Clusters:\n   Number of clusters: 5\n   Cluster 1: 223 events, mean temp 5.5¬∞C\n   Cluster 2: 4 events, mean temp 6.0¬∞C\n   Cluster 3: 28 events, mean temp 26.1¬∞C\n   Cluster 4: 21 events, mean temp 12.7¬∞C\n   Cluster 5: 163 events, mean temp 12.6¬∞C\n\n======================================================================\n```\n:::\n:::\n\n\n---\n\n## Note\n\nThis analysis uses synthetic climate data for demonstration. In production, this framework can be applied to real ERA5 reanalysis data or observational climate datasets. The methods shown here‚Äîextreme value theory, return period analysis, and event clustering‚Äîare standard approaches in climate risk assessment.\n\n",
    "supporting": [
      "climate-extremes-explorer_files"
    ],
    "filters": [],
    "includes": {}
  }
}